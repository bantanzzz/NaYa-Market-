<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NaYa Market</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
  <!-- Navbar -->
  <nav class="bg-white shadow-md px-4 py-3 flex justify-between items-center sticky top-0 z-10">
    <div class="text-2xl md:text-3xl font-extrabold text-green-700 tracking-tight">NaYa Market</div>
    <a href="vendor.html" class="bg-green-600 text-white px-4 py-2 rounded-lg font-medium shadow hover:bg-green-700 transition">Become a Vendor</a>
  </nav>

  <!-- Hero Section -->
  <section class="flex flex-col items-center justify-center text-center py-12 px-4 bg-gradient-to-br from-green-100 to-green-50">
    <h1 class="text-3xl sm:text-4xl md:text-5xl font-extrabold text-green-800 mb-4 leading-tight">Discover Amazing Vendors Near You</h1>
    <p class="text-lg md:text-xl text-green-700 max-w-2xl mb-6">Explore a variety of businesses and connect directly with trusted vendors in your area. Shop local, support dreams!</p>
    <a href="#vendors" class="inline-block bg-green-600 text-white px-6 py-3 rounded-lg font-semibold shadow hover:bg-green-700 transition">Browse Vendors</a>
  </section>

  <!-- Search Filter -->
  <div class="flex justify-center my-6 px-4">
    <input type="text" id="searchInput" placeholder="Search products..." class="w-full max-w-md px-4 py-2 border border-gray-300 rounded-full shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">
  </div>

  <!-- Category Filters -->
  <div class="flex flex-wrap justify-center gap-3 my-8 px-2" id="category-filters">
    <button data-category="Fashion" class="category-btn flex items-center gap-2 bg-pink-50 border border-pink-400 text-pink-700 px-4 py-2 rounded-full font-medium shadow-sm hover:bg-pink-400 hover:text-white transition focus:ring-2 focus:ring-pink-300">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16l4-4-4-4m16 8l-4-4 4-4M12 20V4"/></svg>
      Fashion
    </button>
    <button data-category="Electronics" class="category-btn flex items-center gap-2 bg-blue-50 border border-blue-400 text-blue-700 px-4 py-2 rounded-full font-medium shadow-sm hover:bg-blue-400 hover:text-white transition focus:ring-2 focus:ring-blue-300">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="7" y="4" width="10" height="16" rx="2"/><path d="M11 5h2"/></svg>
      Electronics
    </button>
    <button data-category="Food" class="category-btn flex items-center gap-2 bg-yellow-50 border border-yellow-400 text-yellow-700 px-4 py-2 rounded-full font-medium shadow-sm hover:bg-yellow-400 hover:text-white transition focus:ring-2 focus:ring-yellow-300">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4 17h16M4 13h16M4 9h16M4 5h16"/></svg>
      Food
    </button>
    <button data-category="Services" class="category-btn flex items-center gap-2 bg-green-50 border border-green-400 text-green-700 px-4 py-2 rounded-full font-medium shadow-sm hover:bg-green-400 hover:text-white transition focus:ring-2 focus:ring-green-300">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9.75 17L9 21h6l-.75-4M4 4h16v2a2 2 0 01-2 2H6a2 2 0 01-2-2V4z"/></svg>
      Services
    </button>
    <button data-category="All" class="category-btn flex items-center gap-2 bg-gray-100 border border-gray-300 text-gray-700 px-4 py-2 rounded-full font-medium shadow-sm hover:bg-gray-300 hover:text-white transition focus:ring-2 focus:ring-gray-300">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>
      All
    </button>
  </div>

  <!-- Vendor Grid -->
  <div id="vendors" class="flex-1 w-full max-w-7xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 pb-12 px-4">
  </div>

  <footer class="bg-white border-t mt-auto py-6 text-center text-gray-400 text-sm">
    &copy; 2024 NaYa Market. All rights reserved.
  </footer>

  <script type="module">
    // ðŸ”¸ Firebase SDKs
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    // ðŸ”¸ Replace with your own Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyDXfcM8ClwOJE8Zv6u-N-RuLCxNnjwXuus",
      authDomain: "naya-market-60190.firebaseapp.com",
      projectId: "naya-market-60190",
      storageBucket: "naya-market-60190.firebasestorage.app",
      messagingSenderId: "591341489607",
      appId: "1:591341489607:web:f7b75b28d85d7481869de2"
    };

    // ðŸ”¸ Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    
    // Category filter logic
    const categoryButtons = document.querySelectorAll('.category-btn');
    const vendorCards = document.querySelectorAll('.vendor-card');
    let allVendorCards = [...vendorCards]; // Copy existing cards

    // Load vendor products from Firebase Firestore
    async function loadVendorProducts() {
      try {
        const querySnapshot = await getDocs(collection(db, "vendors"));
        const vendorsContainer = document.getElementById('vendors');
        
        querySnapshot.forEach((doc) => {
          const product = doc.data();
          const card = document.createElement('div');
          card.className = 'vendor-card bg-white rounded-2xl shadow-lg p-6 flex flex-col items-center hover:shadow-2xl transition';
          card.setAttribute('data-category', product.category);
          
          // Determine color based on category
          let colorClass = 'green';
          if (product.category === 'Fashion') colorClass = 'pink';
          else if (product.category === 'Electronics') colorClass = 'blue';
          else if (product.category === 'Food') colorClass = 'yellow';
          
          card.innerHTML = `
            <img src="${product.image}" alt="Product" class="w-28 h-28 object-cover rounded-full mb-4 border-4 border-${colorClass}-100 shadow">
            <h2 class="text-xl font-bold mb-1 text-${colorClass}-700">${product.name}</h2>
            <p class="text-gray-500 mb-1 text-sm">${product.category} <span class="mx-1">â€¢</span> ${product.location}</p>
            <p class="text-gray-500 mb-1 text-sm">Le ${product.price}</p>
            <p class="text-gray-600 text-sm mb-2 hidden description">${product.description || ''}</p>
            <button class="text-green-600 text-sm font-medium mb-2 show-description">Show Description</button>
            <a href="https://wa.me/${product.whatsapp}?text=I'm%20interested%20in%20buying%20${product.name}%20priced%20at%20Le%20${product.price}" target="_blank" class="mt-2 bg-green-500 text-white px-4 py-2 rounded-full font-medium flex items-center gap-2 hover:bg-green-600 transition shadow">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m6-5v5a2 2 0 01-2 2H9a2 2 0 01-2-2v-5m6-5V6a2 2 0 00-2-2H9a2 2 0 00-2 2v2" /></svg>
              Buy Now
            </a>
            <a href="https://wa.me/${product.whatsapp}" target="_blank" class="mt-3 bg-${colorClass}-500 text-white px-4 py-2 rounded-full font-medium flex items-center gap-2 hover:bg-${colorClass}-600 transition shadow">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16.72 11.06a6.5 6.5 0 10-5.66 5.66l2.12-2.12a1 1 0 01.7-.29h.01a1 1 0 01.7.29l2.12 2.12a6.5 6.5 0 00.01-5.66z" /></svg>
              WhatsApp
            </a>
          `;
          
          vendorsContainer.appendChild(card);
          allVendorCards.push(card);
        });
      } catch (error) {
        console.error("Error loading products from Firebase: ", error);
        // Fallback to localStorage if Firebase fails
        const savedProducts = localStorage.getItem('vendorProducts');
        if (savedProducts) {
          const vendorProducts = JSON.parse(savedProducts);
          const vendorsContainer = document.getElementById('vendors');
          
          vendorProducts.forEach((product, index) => {
            const card = document.createElement('div');
            card.className = 'vendor-card bg-white rounded-2xl shadow-lg p-6 flex flex-col items-center hover:shadow-2xl transition';
            card.setAttribute('data-category', product.category);
            
            // Determine color based on category
            let colorClass = 'green';
            if (product.category === 'Fashion') colorClass = 'pink';
            else if (product.category === 'Electronics') colorClass = 'blue';
            else if (product.category === 'Food') colorClass = 'yellow';
            
            card.innerHTML = `
              <img src="${product.image}" alt="Product" class="w-28 h-28 object-cover rounded-full mb-4 border-4 border-${colorClass}-100 shadow">
              <h2 class="text-xl font-bold mb-1 text-${colorClass}-700">${product.name}</h2>
              <p class="text-gray-500 mb-1 text-sm">${product.category} <span class="mx-1">â€¢</span> ${product.location}</p>
              <p class="text-gray-500 mb-1 text-sm">Le ${product.price}</p>
              <p class="text-gray-600 text-sm mb-2 hidden description">${product.description || ''}</p>
              <button class="text-green-600 text-sm font-medium mb-2 show-description">Show Description</button>
              <a href="https://wa.me/${product.whatsapp}?text=I'm%20interested%20in%20buying%20${product.name}%20priced%20at%20Le%20${product.price}" target="_blank" class="mt-2 bg-green-500 text-white px-4 py-2 rounded-full font-medium flex items-center gap-2 hover:bg-green-600 transition shadow">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m6-5v5a2 2 0 01-2 2H9a2 2 0 01-2-2v-5m6-5V6a2 2 0 00-2-2H9a2 2 0 00-2 2v2" /></svg>
                Buy Now
              </a>
              <a href="https://wa.me/${product.whatsapp}" target="_blank" class="mt-3 bg-${colorClass}-500 text-white px-4 py-2 rounded-full font-medium flex items-center gap-2 hover:bg-${colorClass}-600 transition shadow">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16.72 11.06a6.5 6.5 0 10-5.66 5.66l2.12-2.12a1 1 0 01.7-.29h.01a1 1 0 01.7.29l2.12 2.12a6.5 6.5 0 00.01-5.66z" /></svg>
                WhatsApp
              </a>
            `;
            
            vendorsContainer.appendChild(card);
            allVendorCards.push(card);
          });
        }
      }
    }

    categoryButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const selected = btn.getAttribute('data-category');
        categoryButtons.forEach(b => b.classList.remove('ring', 'ring-2', 'ring-offset-2'));
        btn.classList.add('ring', 'ring-2', 'ring-offset-2');
        
        // Trigger search to apply both category and search filters
        searchInput.dispatchEvent(new Event('input'));
      });
    });
    
    // Search functionality
    const searchInput = document.getElementById('searchInput');
    searchInput.addEventListener('input', () => {
      const searchTerm = searchInput.value.toLowerCase();
      const selectedCategory = document.querySelector('.category-btn.ring')?.getAttribute('data-category') || 'All';
      
      allVendorCards.forEach(card => {
        const name = card.querySelector('h2')?.textContent.toLowerCase() || '';
        const category = card.getAttribute('data-category').toLowerCase();
        const location = card.querySelector('p')?.textContent.toLowerCase() || '';
        
        const matchesSearch = searchTerm === '' ||
          name.includes(searchTerm) ||
          category.includes(searchTerm) ||
          location.includes(searchTerm);
          
        const matchesCategory = selectedCategory === 'All' || category === selectedCategory;
        
        if (matchesSearch && matchesCategory) {
          card.style.display = '';
        } else {
          card.style.display = 'none';
        }
      });
    });
    
    // Set default to All
    document.querySelector('.category-btn[data-category="All"]').click();
    
    // Load vendor products
    loadVendorProducts();
    
    // Description toggle functionality
    function toggleDescription() {
      const descriptions = document.querySelectorAll('.description');
      const buttons = document.querySelectorAll('.show-description');
      
      buttons.forEach((button, index) => {
        button.addEventListener('click', () => {
          const description = descriptions[index];
          if (description.classList.contains('hidden')) {
            description.classList.remove('hidden');
            button.textContent = 'Hide Description';
          } else {
            description.classList.add('hidden');
            button.textContent = 'Show Description';
          }
        });
      });
    }
    
    // Call toggleDescription after products are loaded
    setTimeout(toggleDescription, 1000);
  </script>
</body>
</html>